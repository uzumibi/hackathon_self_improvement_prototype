
=== Iteration 1/1 ===
[state] {'num_samples': 8, 'training_steps': 5, 'learning_rate': 0.0001, 'focus_axis': None, 'failure_report_path': None, 'policy_path': '/home/ghoti/hackathon_playground/wandb_mcp_challenge/agent_policy.json'}
[data] skip initial generation: existing rows=16
[run] python3 ft_music_params.py
Traceback (most recent call last):
  File "/home/ghoti/hackathon_playground/ft_music_params.py", line 125, in <module>
    main()
  File "/home/ghoti/hackathon_playground/ft_music_params.py", line 109, in main
    job = client.jobs.create(
  File "/home/ghoti/.local/lib/python3.10/site-packages/mistralai/jobs.py", line 47, in create
    for response in single_response:
  File "/home/ghoti/.local/lib/python3.10/site-packages/mistralai/client.py", line 148, in _request
    yield self._check_response(response)
  File "/home/ghoti/.local/lib/python3.10/site-packages/mistralai/client.py", line 77, in _check_response
    self._check_response_status_codes(response)
  File "/home/ghoti/.local/lib/python3.10/site-packages/mistralai/client.py", line 62, in _check_response_status_codes
    raise MistralAPIException.from_response(
mistralai.exceptions.MistralAPIException: Status: 422. Message: {"detail": "Model not available for this type of fine-tuning (completion). Available model(s): "}

[ft] fine-tuning failed -> fallback evaluation model: mistral-small-latest
[run] python3 eval_music_params.py
{
  "overall_mae": 0.31250000000000006,
  "within_tolerance_rate": 0.0,
  "mae_per_axis": {
    "energy": 0.43124999999999997,
    "warmth": 0.48749999999999993,
    "brightness": 0.23125000000000007,
    "acousticness": 0.2000000000000001,
    "complexity": 0.21875000000000003,
    "nostalgia": 0.3062500000000001
  },
  "failure_counts_per_axis": {
    "energy": 10,
    "warmth": 12,
    "brightness": 6,
    "acousticness": 7,
    "complexity": 5,
    "nostalgia": 8
  },
  "failure_report_path": "data/eval_failure_report_iter_1.json"
}

/home/ghoti/.local/lib/python3.10/site-packages/pydantic/_internal/_fields.py:132: UserWarning: Field "model_ref" in ModelCreateRes has conflict with protected namespace "model_".

You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
  warnings.warn(
/home/ghoti/.local/lib/python3.10/site-packages/requests/__init__.py:113: RequestsDependencyWarning: urllib3 (2.2.2) or chardet (6.0.0.post1)/charset_normalizer (3.3.2) doesn't match a supported version!
  warnings.warn(
/home/ghoti/.local/lib/python3.10/site-packages/pydantic/_internal/_fields.py:132: UserWarning: Field "model_configuration" in DynamicLeaderboardConfig has conflict with protected namespace "model_".

You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
  warnings.warn(
[36m[1mweave[0m: weave version 0.52.29 is available!  To upgrade, please run:
[36m[1mweave[0m:  $ pip install weave --upgrade
[36m[1mweave[0m: Logged in as Weights & Biases user: kazuki-takahashi-research.
[36m[1mweave[0m: View Weave data at https://wandb.ai/kazuki-takahashi-research-university-of-tokyo/music-params-eval/weave
[36m[1mweave[0m: ðŸ© https://wandb.ai/kazuki-takahashi-research-university-of-tokyo/music-params-eval/r/call/019ca227-9264-732e-89a3-4327b646446e
[36m[1mweave[0m: ðŸ© https://wandb.ai/kazuki-takahashi-research-university-of-tokyo/music-params-eval/r/call/019ca227-951f-7bd8-9a29-016dc69a85aa
[36m[1mweave[0m: ðŸ© https://wandb.ai/kazuki-takahashi-research-university-of-tokyo/music-params-eval/r/call/019ca227-986d-7aa7-8b10-9e4735248736
[36m[1mweave[0m: ðŸ© https://wandb.ai/kazuki-takahashi-research-university-of-tokyo/music-params-eval/r/call/019ca227-9ad2-72e6-8c69-1354e7b99e0e
[36m[1mweave[0m: ðŸ© https://wandb.ai/kazuki-takahashi-research-university-of-tokyo/music-params-eval/r/call/019ca227-9e4f-76b2-9103-910ca15e77ea
[36m[1mweave[0m: ðŸ© https://wandb.ai/kazuki-takahashi-research-university-of-tokyo/music-params-eval/r/call/019ca227-a148-7a5a-967d-099a9edafe6a
[36m[1mweave[0m: ðŸ© https://wandb.ai/kazuki-takahashi-research-university-of-tokyo/music-params-eval/r/call/019ca227-a498-740b-8298-5a06818f2fee
[36m[1mweave[0m: ðŸ© https://wandb.ai/kazuki-takahashi-research-university-of-tokyo/music-params-eval/r/call/019ca227-a82a-7384-8dcc-1468431784f6
[36m[1mweave[0m: ðŸ© https://wandb.ai/kazuki-takahashi-research-university-of-tokyo/music-params-eval/r/call/019ca227-aaec-7b54-999a-43d75bcd06ec
[36m[1mweave[0m: ðŸ© https://wandb.ai/kazuki-takahashi-research-university-of-tokyo/music-params-eval/r/call/019ca227-ad8c-7ad0-b971-94085bd2582b
[36m[1mweave[0m: ðŸ© https://wandb.ai/kazuki-takahashi-research-university-of-tokyo/music-params-eval/r/call/019ca227-b1d5-7861-a8c5-812b62705c73
[36m[1mweave[0m: ðŸ© https://wandb.ai/kazuki-takahashi-research-university-of-tokyo/music-params-eval/r/call/019ca227-b590-7b52-a7c9-1514c469c274
[36m[1mweave[0m: ðŸ© https://wandb.ai/kazuki-takahashi-research-university-of-tokyo/music-params-eval/r/call/019ca227-b8ed-7a02-aa03-6f5f60406c6e
[36m[1mweave[0m: ðŸ© https://wandb.ai/kazuki-takahashi-research-university-of-tokyo/music-params-eval/r/call/019ca227-bc77-7e9a-8b6c-ed608c7480c6
[36m[1mweave[0m: ðŸ© https://wandb.ai/kazuki-takahashi-research-university-of-tokyo/music-params-eval/r/call/019ca227-c100-76d7-b75b-4545d5b27d83
[36m[1mweave[0m: ðŸ© https://wandb.ai/kazuki-takahashi-research-university-of-tokyo/music-params-eval/r/call/019ca227-c4ad-7881-b338-10dae4369e5d

[metrics] mae=0.31250000000000006 worst_axis=warmth
[decision] plateau -> steps+10 and lr*0.8 / target data on weak axis: warmth
[policy] {'updated': True, 'worst_axis': 'warmth', 'path': '/home/ghoti/hackathon_playground/wandb_mcp_challenge/agent_policy.json', 'snapshot': '/home/ghoti/hackathon_playground/wandb_mcp_challenge/generated_skills/policy_iter_01.json'}
[artifact] /home/ghoti/hackathon_playground/wandb_mcp_challenge/generated_skills/iter_01.json
